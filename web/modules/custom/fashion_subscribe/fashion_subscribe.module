<?php

/**
 * Implements hook_cron().
 * @throws Exception
 */
function fashion_subscribe_cron()
{
    $items = [];

    $stateData = \Drupal::state()->get('users');
    $allDataFromConfig = \Drupal::configFactory()->getEditable('fashion_subscribe.settings')->get();

// all saved array_unique data from config and state
    $items = array_merge($stateData, $allDataFromConfig);

    foreach ($items as $key => $value) {
        $connection = \Drupal::database();
        $query = $connection->insert('fashion_subscribe')
            ->fields([
                'nid' => $value['nid'],
                'mail' =>$key,
                'created' => $value['created'],
                'email_notification' => $value['email_notification'],
            ])->execute();
    }
//   $a=1;
}